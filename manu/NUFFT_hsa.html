
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>NUFFT(device) &#8212; PyNUFFT 2022.1.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/guzzle.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Multiple NUFFT instances" href="multiple_NUFFT.html" />
    <link rel="prev" title="NUFFT" href="NUFFT_cpu.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="multiple_NUFFT.html" title="Multiple NUFFT instances"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="NUFFT_cpu.html" title="NUFFT"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PyNUFFT 2022.1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="init.html" accesskey="U">Manual</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">NUFFT(device)</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="NUFFT_cpu.html"
                          title="previous chapter">NUFFT</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="multiple_NUFFT.html"
                          title="next chapter">Multiple NUFFT instances</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/manu/NUFFT_hsa.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../index.html">Docs</a></li>
              
                <li><a href="init.html">Manual</a></li>
              
              <li>NUFFT(device)</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <section id="nufft-device">
<h1>NUFFT(device)<a class="headerlink" href="#nufft-device" title="Permalink to this headline">¶</a></h1>
<p><strong>The NUFFT(device) class</strong></p>
<p>NUFFT(device) computes NUFFT on the CUDA/OpenCL device.</p>
<p>Defining the equispaced to non-Cartesian transform as  operator <span class="math notranslate nohighlight">\(A\)</span>, the
NUFFT(device) class provides the following methods:</p>
<ul class="simple">
<li><p>forward() method computes the single forward operation <span class="math notranslate nohighlight">\(A\)</span>.</p></li>
<li><p>adjoint() method computes the single adjoint operation  <span class="math notranslate nohighlight">\(A^H\)</span>.</p></li>
<li><p>selfadjoint() method computes the single selfadjoint operation <span class="math notranslate nohighlight">\(A^H A\)</span>.</p></li>
<li><p>solve() method now only offers ‘cg’, ‘dc’, ‘L1TVOLS’</p></li>
</ul>
<p><strong>Attributes</strong></p>
<ul class="simple">
<li><p>NUFFT.ndims: the dimension</p></li>
<li><p>NUFFT.ft_axes: the axes where the FFT takes place</p></li>
<li><p>NUFFT.Nd: Tuple, the dimensions of the image</p></li>
<li><p>NUFFT.Kd: Tuple, the dimensions of oversampled k-space</p></li>
</ul>
<p><strong>Acceleration on PyCUDA/PyOpenCL</strong></p>
<p>The NUFFT_hsa was designed to accelerate the NUFFT function
on the multi-core CPU and GPU, using PyOpenCL and PyCUDA backends.
This was made possible by using Reikna meta-package.</p>
<p>If multiple NUFFT(device) objects are created with the PyCUDA backend,
each call can be executed only after the  context has ‘popped up’. This is
achieved by the decorator function push_cuda_context():
calling NUFFT(device) methods will trigger the decorator and get the context popped up.
However, PyOpenCL has no such restriction
and the call will automatically bypass the decorator for the NUFFT(device)
with the PyOpenCL backend.</p>
<p>Different objects can be constructed on different PyCUDA and PyOpenCL backends.</p>
<p><strong>The life-cycle of the PyNUFFT(device) object</strong></p>
<p>NUFFT(device) employs the plan-execution two-stage model.
This can maximize the runtime speed, at the cost of the extra precomputation times and extra memory.</p>
<p>Instantiating an NUFFT(device) instance also initiates the context and defines some instance attributes.
The context is linked to the accelerator and the kernels are compiled on the chosen device.
Instance attributes will be replaced later when the method plan() is called.</p>
<p>Then the plan() method calls the helper.plan() function,
which constructs the scaling factor and the interpolator.
The interpolator is precomputed and stored as multiple 1D ELLpack (ELL) sparse matrices.
Each ELL matrix preserves the sparse matrix as the data and column indices.
Multi-dimensional interpolators are implemented as a concatenated multiple 1D ELL sparse matrices.
The actual data and column indices are inferred from the meshindex.
At the end of the plan() method, the offload() method transfers the
precomputed arrays to the accelerator.</p>
<p>The run-time computations reuse the saved scaling factors and
interpolators.</p>
</section>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="NUFFT_cpu.html" title="previous chapter (use the left arrow)">NUFFT</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="multiple_NUFFT.html" title="next chapter (use the right arrow)">Multiple NUFFT instances</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="multiple_NUFFT.html" title="Multiple NUFFT instances"
             >next</a> |</li>
        <li class="right" >
          <a href="NUFFT_cpu.html" title="NUFFT"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PyNUFFT 2022.1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="init.html" >Manual</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">NUFFT(device)</a></li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2012-2022, PyNUFFT services. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>